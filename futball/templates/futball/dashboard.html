{% extends "base.html" %} 

{% block title %}Dashboard{% endblock %} 

{% block c_title %}League Dashboard{% endblock %}

{% block content %}
<div class="competition-search">
  <form method="get" class="search-form">
      <div class="input-field field">
        <select name="competition" id="competition">
          {% for c in competitions %}
            <option value="{{ c.id }}"
            {% if selected_competition and c.id == selected_competition.id %}
              selected
            {% endif %}>
            {{ c.name }}
          </option>
          {% endfor %}
        </select>
        <label>Competition:</label>
      </div>
      <div class="input-field field">
        <select name="season" id="season">
          {% for s in seasons %} 
            <option value="{{ s.id }}"
              {% if selected_season and s.id == selected_season.id %}
              selected
              {% endif %}>
            {{ s.name }}
          </option>
          {% endfor %}
        </select>
        <label>Season:</label>
      </div>
      <button class="btn waves-effect waves-light btn-accent" type="submit">
        Search
        <i class="material-icons right">search</i>
      </button>
  </form>
</div>

<div class="row">
  <!-- KPI CARDS -->
  <div class="col s12">
    <div class="row kpi-row">
      <div class="col s12 m6 l3">
        <div class="stat-card">
          <span class="card-label">Matches</span>
          <strong class="card-value">{{ total_matches }}</strong>
        </div>
      </div>
      <div class="col s12 m6 l3">
        <div class="stat-card">
          <span class="card-label">Goals</span>
          <strong class="card-value">{{ total_goals }}</strong>
        </div>
      </div>
      <div class="col s12 m6 l3">
        <div class="stat-card">
          <span class="card-label">Avg Goals / Match</span>
          <strong class="card-value">{{ avg_goals }}</strong>
        </div>
      </div>
      <div class="col s12 m6 l3">
        <div class="stat-card">
          <span class="card-label">Leader</span>
          <strong class="card-value">{{ leader }}</strong>
        </div>
      </div>
    </div>
  </div>

  <!-- INSIGHT -->
  <div class="col s12">
    <div class="row insight-row">
      <div class="col s12 m6">
        <div class="insight-card">
          <span class="card-label">Best Attack (xG)</span>
          <strong class="card-value">{{ top_attack }}</strong>
        </div>
      </div>
      <div class="col s12 m6">
        <div class="insight-card">
          <span class="card-label">Best Defence (xGA)</span>
          <strong class="card-value">{{ best_defence }}</strong>
        </div>
      </div>
    </div>
  </div>

  <!-- TABLES -->
  <div class="col s12">
    <div class="row table-row">
      <div class="col s12 l8">
        <div class="table-card">
          <h5 class="table-title">Top 5 Teams</h5>
          <table class="data-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Team</th>
                <th>Pts</th>
              </tr>
            </thead>
            <tbody>
              {% for team, stats in top_5 %}
              <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ team }}</td>
                <td>{{ stats.points }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

      <div class="col s12 l4">
        <div class="table-card">
          <h5 class="table-title">Relegation Zone</h5>
          <table class="data-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Team</th>
                <th>Pts</th>
              </tr>
            </thead>
            <tbody>
              {% for team, stats in bottom_3 %}
              <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ team }}</td>
                <td>{{ stats.points }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
